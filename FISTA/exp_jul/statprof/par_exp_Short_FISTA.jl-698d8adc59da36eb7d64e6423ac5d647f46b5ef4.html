<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - module\par_exp_Short_FISTA.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Wed, 18 Dec 2024 19:42:21
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>module par_Short</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    export demand_sparse, cal_pi, pi_noex, v_cal, Z_SD, short_dual_df, short_solve,</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>           Q, backtracking, equilibrium</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # include&#40;&quot;exp_parameter.jl&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    using LinearAlgebra</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    using Base.Threads</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # using .Parameter</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              44686 &#40;46 &#37;&#41;
              samples spent in demand_sparse
              <br />
              
              44686 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from short_dual_df
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L101'>line 101</a>
              <br />
            </div>
            
            <span class='code'>    function demand_sparse&#40;prm, R::Vector&#123;Float64&#125;, W::Vector&#123;Float64&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>171 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              160 &#40;94 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              11 &#40;6 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        R_S_H &#61; prm.alpha_S_R * &#40;R .^ -prm.power_S_H_R&#41;</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>170 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              164 &#40;96 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              6 &#40;4 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        W_S_H &#61; prm.alpha_S_W * &#40;W .^ -prm.power_S_H_W&#41;</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>8491 &#40;9 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              8491 &#40;100 &#37;&#41;
              samples spent calling
              <a href='adjtrans.jl-b089a6402e7501a3eba52d85195e09254eec010a.html#L468'>*</a>
              <br />
            </div>
            <span class='code'>        RW_S_H &#61; R_S_H * W_S_H&#39;</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>182 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              167 &#40;92 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              15 &#40;8 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        R_L_H &#61; prm.alpha_L_R * &#40;R .^ -prm.power_L_H_R&#41;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>172 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              161 &#40;94 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              11 &#40;6 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        W_L_H &#61; prm.alpha_L_W * &#40;W .^ -prm.power_L_H_W&#41;</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>9435 &#40;10 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              9435 &#40;100 &#37;&#41;
              samples spent calling
              <a href='adjtrans.jl-b089a6402e7501a3eba52d85195e09254eec010a.html#L468'>*</a>
              <br />
            </div>
            <span class='code'>        RW_L_H &#61; R_L_H * W_L_H&#39;</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>164 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              155 &#40;95 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              9 &#40;5 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        R_S_F &#61; prm.beta_S_R * &#40;R .^ -prm.power_S_F_R&#41;</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>164 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              156 &#40;95 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              8 &#40;5 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        W_S_F &#61; prm.beta_S_W * &#40;W .^ -prm.power_S_F_W&#41;</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>168 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              156 &#40;93 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              12 &#40;7 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        R_L_F &#61; prm.beta_L_R * &#40;R .^ -prm.power_L_F_R&#41;</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>171 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              159 &#40;93 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              12 &#40;7 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        W_L_F &#61; prm.beta_L_W * &#40;W .^ -prm.power_L_F_W&#41;</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>13285 &#40;14 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              13285 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>        S_H &#61; prm.T_power .* RW_S_H</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>12063 &#40;12 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              12063 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>        L_H &#61; prm.T_power .* RW_L_H</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>39 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              39 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>        S_F &#61; R_S_F .* W_S_F</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>11 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              11 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>        L_F &#61; R_L_F .* W_L_F</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return S_H, L_H, S_F, L_F</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    function cal_pi&#40;prm, R::Vector&#123;Float64&#125;, W::Vector&#123;Float64&#125;, m::Vector&#123;Float64&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 利潤関数を計算する関数</span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        R_pi &#61; prm.beta_L_R * &#40;R .^ -prm.power_L_F_R&#41;</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        W_pi &#61; prm.beta_S_W * &#40;W .^ -prm.power_S_F_W&#41;</span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        pi &#61; prm.D * m &#43;</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>             prm.pi_beta * &#40;R_pi .* W_pi&#41;</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return pi</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              250 &#40;0 &#37;&#41;
              samples spent in pi_noex
              <br />
              
              250 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from Z_SD
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L87'>line 87</a>
              <br />
            </div>
            
            <span class='code'>    function pi_noex&#40;prm, R::Vector&#123;Float64&#125;, W::Vector&#123;Float64&#125;, m::Vector&#123;Float64&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 需要関数を設定する関数</span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>117 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              113 &#40;97 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              2 &#40;2 &#37;&#41;
              samples spent calling
              <a href='float.jl-5176e49bf78ac37b4c67f3556f19d40c62247ba2.html#L407'>-</a>
              <br />
              2 &#40;2 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        R_pi &#61; prm.beta_L_R * &#40;R .^ -prm.power_L_F_R&#41;</span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>122 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              120 &#40;98 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              2 &#40;2 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        W_pi &#61; prm.beta_S_W * &#40;W .^ -prm.power_S_F_W&#41;</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>11 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              7 &#40;64 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              4 &#40;36 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        pi &#61; prm.pi_beta * &#40;R_pi .* W_pi&#41;</span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return pi</span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              14106 &#40;15 &#37;&#41;
              samples spent in v_cal
              <br />
              1 &#40;0 &#37;&#41; &#40;ex.&#41;,
              14105 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from Z_SD
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L85'>line 85</a>
              <br />
              
              1 &#40;0 &#37;&#41; &#40;incl.&#41;
              when called from short_solve
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L138'>line 138</a>
              <br />
            </div>
            
            <span class='code'>    function v_cal&#40;prm, R::Vector&#123;Float64&#125;, W::Vector&#123;Float64&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 間接効用関数を計算する関数</span>
          </td>
        </tr>
        <tr id='L66'>
          <td class='lineno'>66</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L67'>
          <td class='lineno'>67</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>119 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              111 &#40;93 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              8 &#40;7 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        R_v &#61; prm.alpha_L_R * &#40;R .^ -prm.power_L_H_R&#41;</span>
          </td>
        </tr>
        <tr id='L68'>
          <td class='lineno'>68</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>122 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              111 &#40;91 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              11 &#40;9 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        W_v &#61; prm.alpha_S_W * &#40;W .^ -prm.power_S_H_W&#41;</span>
          </td>
        </tr>
        <tr id='L69'>
          <td class='lineno'>69</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4963 &#40;5 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4963 &#40;100 &#37;&#41;
              samples spent calling
              <a href='adjtrans.jl-b089a6402e7501a3eba52d85195e09254eec010a.html#L468'>*</a>
              <br />
            </div>
            <span class='code'>        RW_v &#61; R_v * W_v&#39;</span>
          </td>
        </tr>
        <tr id='L70'>
          <td class='lineno'>70</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L71'>
          <td class='lineno'>71</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>8901 &#40;9 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              8894 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              7 &#40;0 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>        v &#61; prm.E * W .&#43;</span>
          </td>
        </tr>
        <tr id='L72'>
          <td class='lineno'>72</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            prm.T_power_v .*</span>
          </td>
        </tr>
        <tr id='L73'>
          <td class='lineno'>73</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            RW_v</span>
          </td>
        </tr>
        <tr id='L74'>
          <td class='lineno'>74</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L75'>
          <td class='lineno'>75</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return v</span>
          </td>
        </tr>
        <tr id='L76'>
          <td class='lineno'>76</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L77'>
          <td class='lineno'>77</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L78'>
          <td class='lineno'>78</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              23234 &#40;24 &#37;&#41;
              samples spent in Z_SD
              <br />
              1 &#40;0 &#37;&#41; &#40;ex.&#41;,
              11757 &#40;51 &#37;&#41; &#40;incl.&#41;
              when called from backtracking
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L202'>line 202</a>
              <br />
              
              11477 &#40;49 &#37;&#41; &#40;incl.&#41;
              when called from backtracking
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L207'>line 207</a>
              <br />
            </div>
            
            <span class='code'>    function Z_SD&#40;prm, RW::Vector&#123;Float64&#125;, m::Vector&#123;Float64&#125;, n::Matrix&#123;Float64&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L79'>
          <td class='lineno'>79</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # 目的関数を計算する関数</span>
          </td>
        </tr>
        <tr id='L80'>
          <td class='lineno'>80</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L81'>
          <td class='lineno'>81</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>9 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              5 &#40;56 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L977'>getindex</a>
              <br />
              4 &#40;44 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L975'>getindex</a>
              <br />
            </div>
            <span class='code'>        R &#61; RW&#91;1:prm.K&#93;</span>
          </td>
        </tr>
        <tr id='L82'>
          <td class='lineno'>82</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>11 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              9 &#40;82 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L975'>getindex</a>
              <br />
              2 &#40;18 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L977'>getindex</a>
              <br />
            </div>
            <span class='code'>        W &#61; RW&#91;&#40;prm.K &#43; 1&#41;:end&#93;</span>
          </td>
        </tr>
        <tr id='L83'>
          <td class='lineno'>83</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L84'>
          <td class='lineno'>84</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 間接効用関数の計算</span>
          </td>
        </tr>
        <tr id='L85'>
          <td class='lineno'>85</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>14105 &#40;15 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              14105 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L64'>v_cal</a>
              <br />
            </div>
            <span class='code'>        v_value &#61; v_cal&#40;prm, R, W&#41;</span>
          </td>
        </tr>
        <tr id='L86'>
          <td class='lineno'>86</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L87'>
          <td class='lineno'>87</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>9108 &#40;9 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              7964 &#40;87 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              884 &#40;10 &#37;&#41;
              samples spent calling
              <a href='reducedim.jl-64e2687ea6e0895a3e81e792b3c7a7e8a2d5af47.html#L1010'>sum</a>
              <br />
              250 &#40;3 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L53'>pi_noex</a>
              <br />
              9 &#40;0 &#37;&#41;
              samples spent calling
              <a href='matmul.jl-4313d1118414e765d35d0447dce0d2adace246d1.html#L15'>dot</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='float.jl-5176e49bf78ac37b4c67f3556f19d40c62247ba2.html#L411'>*</a>
              <br />
            </div>
            <span class='code'>        F_value &#61; sum&#40;v_value .* n&#41; &#43;</span>
          </td>
        </tr>
        <tr id='L88'>
          <td class='lineno'>88</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                  dot&#40;pi_noex&#40;prm, R, W, m&#41;, m&#41; &#43;</span>
          </td>
        </tr>
        <tr id='L89'>
          <td class='lineno'>89</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                  prm.S_bar * sum&#40;R&#41;</span>
          </td>
        </tr>
        <tr id='L90'>
          <td class='lineno'>90</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L91'>
          <td class='lineno'>91</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return F_value</span>
          </td>
        </tr>
        <tr id='L92'>
          <td class='lineno'>92</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L93'>
          <td class='lineno'>93</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L94'>
          <td class='lineno'>94</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              73149 &#40;75 &#37;&#41;
              samples spent in short_dual_df
              <br />
              1 &#40;0 &#37;&#41; &#40;ex.&#41;,
              24939 &#40;34 &#37;&#41; &#40;incl.&#41;
              when called from backtracking
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L201'>line 201</a>
              <br />
              
              24658 &#40;34 &#37;&#41; &#40;incl.&#41;
              when called from short_solve
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L146'>line 146</a>
              <br />
              
              23552 &#40;32 &#37;&#41; &#40;incl.&#41;
              when called from short_solve
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L158'>line 158</a>
              <br />
            </div>
            
            <span class='code'>    function short_dual_df&#40;prm, RW::Vector&#123;Float64&#125;, m::Vector&#123;Float64&#125;, n::Matrix&#123;Float64&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L95'>
          <td class='lineno'>95</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 目的関数の勾配を計算する関数</span>
          </td>
        </tr>
        <tr id='L96'>
          <td class='lineno'>96</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L97'>
          <td class='lineno'>97</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>26 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              19 &#40;73 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L975'>getindex</a>
              <br />
              7 &#40;27 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L977'>getindex</a>
              <br />
            </div>
            <span class='code'>        R &#61; RW&#91;1:prm.K&#93;</span>
          </td>
        </tr>
        <tr id='L98'>
          <td class='lineno'>98</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>8 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4 &#40;50 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L977'>getindex</a>
              <br />
              4 &#40;50 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L975'>getindex</a>
              <br />
            </div>
            <span class='code'>        W &#61; RW&#91;&#40;prm.K &#43; 1&#41;:end&#93;</span>
          </td>
        </tr>
        <tr id='L99'>
          <td class='lineno'>99</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L100'>
          <td class='lineno'>100</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 需要関数の計算</span>
          </td>
        </tr>
        <tr id='L101'>
          <td class='lineno'>101</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>44689 &#40;46 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              44686 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L12'>demand_sparse</a>
              <br />
              3 &#40;0 &#37;&#41;
              samples spent calling
              <a href='tuple.jl-b931f435d465b4928249b33ea5a720375f6a4667.html#L92'>indexed_iterate</a>
              <br />
            </div>
            <span class='code'>        S_H, L_H, S_F, L_F &#61; demand_sparse&#40;prm, R, W&#41;</span>
          </td>
        </tr>
        <tr id='L102'>
          <td class='lineno'>102</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L103'>
          <td class='lineno'>103</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 勾配の計算</span>
          </td>
        </tr>
        <tr id='L104'>
          <td class='lineno'>104</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>14525 &#40;15 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              12986 &#40;89 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              1523 &#40;10 &#37;&#41;
              samples spent calling
              <a href='reducedim.jl-64e2687ea6e0895a3e81e792b3c7a7e8a2d5af47.html#L1010'>sum</a>
              <br />
              16 &#40;0 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L985'>getindex</a>
              <br />
            </div>
            <span class='code'>        dR &#61; prm.S_bar .- sum&#40;S_H .* n, dims&#61;2&#41;&#91;:&#93; .- S_F .* m  # forall i</span>
          </td>
        </tr>
        <tr id='L105'>
          <td class='lineno'>105</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>13866 &#40;14 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              12351 &#40;89 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              1504 &#40;11 &#37;&#41;
              samples spent calling
              <a href='reducedim.jl-64e2687ea6e0895a3e81e792b3c7a7e8a2d5af47.html#L1010'>sum</a>
              <br />
              11 &#40;0 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L985'>getindex</a>
              <br />
            </div>
            <span class='code'>        dW &#61; sum&#40;&#40;prm.E .- L_H&#41; .* n, dims&#61;1&#41;&#91;:&#93; .- L_F .* m  # forall j</span>
          </td>
        </tr>
        <tr id='L106'>
          <td class='lineno'>106</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L107'>
          <td class='lineno'>107</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 勾配を結合して返す</span>
          </td>
        </tr>
        <tr id='L108'>
          <td class='lineno'>108</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>34 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              34 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L2031'>vcat</a>
              <br />
            </div>
            <span class='code'>        dRW &#61; vcat&#40;dR, dW&#41;</span>
          </td>
        </tr>
        <tr id='L109'>
          <td class='lineno'>109</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L110'>
          <td class='lineno'>110</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return dRW</span>
          </td>
        </tr>
        <tr id='L111'>
          <td class='lineno'>111</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L112'>
          <td class='lineno'>112</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L113'>
          <td class='lineno'>113</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              96515 &#40;99 &#37;&#41;
              samples spent in short_solve
              <br />
              1 &#40;0 &#37;&#41; &#40;ex.&#41;,
              96515 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='Profile.jl-c83c366766a4f52baf66e332f391c00e4a306cb1.html#L27'>line 27</a>
              <br />
            </div>
            
            <span class='code'>    function short_solve&#40;</span>
          </td>
        </tr>
        <tr id='L114'>
          <td class='lineno'>114</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        prm,</span>
          </td>
        </tr>
        <tr id='L115'>
          <td class='lineno'>115</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        algprm, </span>
          </td>
        </tr>
        <tr id='L116'>
          <td class='lineno'>116</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        RW_ini::Float64,</span>
          </td>
        </tr>
        <tr id='L117'>
          <td class='lineno'>117</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        m_fixed::Vector&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L118'>
          <td class='lineno'>118</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        n_fixed::Matrix&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L119'>
          <td class='lineno'>119</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        err_short::Float64,</span>
          </td>
        </tr>
        <tr id='L120'>
          <td class='lineno'>120</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        short_itr::Int</span>
          </td>
        </tr>
        <tr id='L121'>
          <td class='lineno'>121</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    &#41;</span>
          </td>
        </tr>
        <tr id='L122'>
          <td class='lineno'>122</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # 短期均衡を解く関数</span>
          </td>
        </tr>
        <tr id='L123'>
          <td class='lineno'>123</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        RW_before &#61; RW_ini * prm.one_2K</span>
          </td>
        </tr>
        <tr id='L124'>
          <td class='lineno'>124</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        p_bar_before &#61; prm.one_2K</span>
          </td>
        </tr>
        <tr id='L125'>
          <td class='lineno'>125</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        L_before &#61; algprm.L</span>
          </td>
        </tr>
        <tr id='L126'>
          <td class='lineno'>126</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        t_before &#61; 1.0</span>
          </td>
        </tr>
        <tr id='L127'>
          <td class='lineno'>127</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        max_value &#61; 0</span>
          </td>
        </tr>
        <tr id='L128'>
          <td class='lineno'>128</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # obj_hist &#61; Dict&#123;Int, Float64&#125;&#40;0 &#61;&gt; 1000.0&#41;</span>
          </td>
        </tr>
        <tr id='L129'>
          <td class='lineno'>129</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        obj_rel_list &#61; &#91;&#93;</span>
          </td>
        </tr>
        <tr id='L130'>
          <td class='lineno'>130</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        RW_box &#61; &#91;&#93;</span>
          </td>
        </tr>
        <tr id='L131'>
          <td class='lineno'>131</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # max_value_box &#61; &#91;&#93;</span>
          </td>
        </tr>
        <tr id='L132'>
          <td class='lineno'>132</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L133'>
          <td class='lineno'>133</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        R_ini &#61; RW_before&#91;1:prm.K&#93;</span>
          </td>
        </tr>
        <tr id='L134'>
          <td class='lineno'>134</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        W_ini &#61; RW_before&#91;&#40;prm.K &#43; 1&#41;:end&#93;</span>
          </td>
        </tr>
        <tr id='L135'>
          <td class='lineno'>135</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L136'>
          <td class='lineno'>136</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        g &#61; 1</span>
          </td>
        </tr>
        <tr id='L137'>
          <td class='lineno'>137</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L138'>
          <td class='lineno'>138</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L64'>v_cal</a>
              <br />
            </div>
            <span class='code'>        if minimum&#40;v_cal&#40;prm, R_ini, W_ini&#41;&#41; &lt; 0</span>
          </td>
        </tr>
        <tr id='L139'>
          <td class='lineno'>139</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            throw&#40;ArgumentError&#40;&quot;v must be non-negative&quot;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L140'>
          <td class='lineno'>140</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L141'>
          <td class='lineno'>141</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L142'>
          <td class='lineno'>142</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for k in 1:short_itr</span>
          </td>
        </tr>
        <tr id='L143'>
          <td class='lineno'>143</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        </span>
          </td>
        </tr>
        <tr id='L144'>
          <td class='lineno'>144</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # Step 1: Backtracking</span>
          </td>
        </tr>
        <tr id='L145'>
          <td class='lineno'>145</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>48222 &#40;50 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              48222 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L197'>backtracking</a>
              <br />
            </div>
            <span class='code'>            L &#61; backtracking&#40;prm, algprm, p_bar_before, L_before, m_fixed, n_fixed&#41;</span>
          </td>
        </tr>
        <tr id='L146'>
          <td class='lineno'>146</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>24658 &#40;25 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              24658 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L94'>short_dual_df</a>
              <br />
            </div>
            <span class='code'>            dZ_SD &#61; short_dual_df&#40;prm, p_bar_before, m_fixed, n_fixed&#41;</span>
          </td>
        </tr>
        <tr id='L147'>
          <td class='lineno'>147</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L148'>
          <td class='lineno'>148</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # Step 2: 解の更新</span>
          </td>
        </tr>
        <tr id='L149'>
          <td class='lineno'>149</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>12 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              12 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>            RW &#61; max.&#40;prm.RW_proj, p_bar_before .- &#40;dZ_SD ./ L&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L150'>
          <td class='lineno'>150</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L151'>
          <td class='lineno'>151</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # Step 3: 収束判定</span>
          </td>
        </tr>
        <tr id='L152'>
          <td class='lineno'>152</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>20 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              17 &#40;85 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              3 &#40;15 &#37;&#41;
              samples spent calling
              <a href='reducedim.jl-64e2687ea6e0895a3e81e792b3c7a7e8a2d5af47.html#L1010'>maximum</a>
              <br />
            </div>
            <span class='code'>            if maximum&#40;abs.&#40;&#40;RW .- RW_before&#41; ./ RW_before&#41;&#41; &lt; err_short</span>
          </td>
        </tr>
        <tr id='L153'>
          <td class='lineno'>153</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                RW_box &#61; vcat&#40;RW_box, RW&#41;</span>
          </td>
        </tr>
        <tr id='L154'>
          <td class='lineno'>154</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                break</span>
          </td>
        </tr>
        <tr id='L155'>
          <td class='lineno'>155</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L156'>
          <td class='lineno'>156</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L157'>
          <td class='lineno'>157</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # Step 4: Adaptive restart</span>
          </td>
        </tr>
        <tr id='L158'>
          <td class='lineno'>158</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>23569 &#40;24 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              23552 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L94'>short_dual_df</a>
              <br />
              12 &#40;0 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              4 &#40;0 &#37;&#41;
              samples spent calling
              <a href='matmul.jl-4313d1118414e765d35d0447dce0d2adace246d1.html#L15'>dot</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='simdloop.jl-57e60b307c4767fbecdad85a83bd62a23ba23086.html#L94'>short_dual_df</a>
              <br />
            </div>
            <span class='code'>            if dot&#40;short_dual_df&#40;prm, RW_before, m_fixed, n_fixed&#41;, RW .- RW_before&#41; &gt; 0</span>
          </td>
        </tr>
        <tr id='L159'>
          <td class='lineno'>159</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                t_before &#61; 1.0</span>
          </td>
        </tr>
        <tr id='L160'>
          <td class='lineno'>160</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L161'>
          <td class='lineno'>161</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L162'>
          <td class='lineno'>162</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # Step 5: momentum項の計算</span>
          </td>
        </tr>
        <tr id='L163'>
          <td class='lineno'>163</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            t &#61; &#40;1.0 &#43; sqrt&#40;1.0 &#43; 4.0 * t_before^2&#41;&#41; / 2.0</span>
          </td>
        </tr>
        <tr id='L164'>
          <td class='lineno'>164</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>29 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              20 &#40;69 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              9 &#40;31 &#37;&#41;
              samples spent calling
              <a href='arraymath.jl-0d99d2d8439427f46e75e9104832725349641197.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>            p_bar &#61; max.&#40;prm.RW_proj, RW .&#43; &#40;&#40;t_before - 1.0&#41; / t&#41; * &#40;RW .- RW_before&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L165'>
          <td class='lineno'>165</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L166'>
          <td class='lineno'>166</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            RW_before &#61; RW</span>
          </td>
        </tr>
        <tr id='L167'>
          <td class='lineno'>167</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            p_bar_before &#61; p_bar</span>
          </td>
        </tr>
        <tr id='L168'>
          <td class='lineno'>168</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            L_before &#61; L</span>
          </td>
        </tr>
        <tr id='L169'>
          <td class='lineno'>169</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            t_before &#61; t</span>
          </td>
        </tr>
        <tr id='L170'>
          <td class='lineno'>170</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            g &#43;&#61; 1</span>
          </td>
        </tr>
        <tr id='L171'>
          <td class='lineno'>171</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L172'>
          <td class='lineno'>172</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L173'>
          <td class='lineno'>173</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        R_hist &#61; RW_box&#91;1:prm.K&#93;</span>
          </td>
        </tr>
        <tr id='L174'>
          <td class='lineno'>174</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        W_hist &#61; RW_box&#91;&#40;prm.K &#43; 1&#41;:end&#93;</span>
          </td>
        </tr>
        <tr id='L175'>
          <td class='lineno'>175</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L176'>
          <td class='lineno'>176</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>3 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              3 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-eeecab1d72543e4bc21214679596a29429794ca9.html#L665'>convert</a>
              <br />
            </div>
            <span class='code'>        R_hist &#61; convert&#40;Vector&#123;Float64&#125;, R_hist&#41;</span>
          </td>
        </tr>
        <tr id='L177'>
          <td class='lineno'>177</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        W_hist &#61; convert&#40;Vector&#123;Float64&#125;, W_hist&#41;</span>
          </td>
        </tr>
        <tr id='L178'>
          <td class='lineno'>178</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L179'>
          <td class='lineno'>179</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return R_hist, W_hist, g, obj_rel_list</span>
          </td>
        </tr>
        <tr id='L180'>
          <td class='lineno'>180</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L181'>
          <td class='lineno'>181</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L182'>
          <td class='lineno'>182</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # function Q&#40;</span>
          </td>
        </tr>
        <tr id='L183'>
          <td class='lineno'>183</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     model::ShortModel,</span>
          </td>
        </tr>
        <tr id='L184'>
          <td class='lineno'>184</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     p::Vector&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L185'>
          <td class='lineno'>185</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     p_bar::Vector&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L186'>
          <td class='lineno'>186</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     L_bar::Float64,</span>
          </td>
        </tr>
        <tr id='L187'>
          <td class='lineno'>187</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     m_fixed::Vector&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L188'>
          <td class='lineno'>188</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     n_fixed::Matrix&#123;Float64&#125;</span>
          </td>
        </tr>
        <tr id='L189'>
          <td class='lineno'>189</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # &#41;</span>
          </td>
        </tr>
        <tr id='L190'>
          <td class='lineno'>190</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     Q &#61; Z_SD&#40;p_bar, m_fixed, n_fixed&#41; &#43;</span>
          </td>
        </tr>
        <tr id='L191'>
          <td class='lineno'>191</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #         dot&#40;p .- p_bar, calculate_short_dual_df&#40;model, p_bar, m_fixed, n_fixed&#41;&#41; &#43;</span>
          </td>
        </tr>
        <tr id='L192'>
          <td class='lineno'>192</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #         0.5 * L_bar * dot&#40;p .- p_bar, p .- p_bar&#41;</span>
          </td>
        </tr>
        <tr id='L193'>
          <td class='lineno'>193</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #     return Q</span>
          </td>
        </tr>
        <tr id='L194'>
          <td class='lineno'>194</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # end</span>
          </td>
        </tr>
        <tr id='L195'>
          <td class='lineno'>195</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L196'>
          <td class='lineno'>196</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L197'>
          <td class='lineno'>197</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              48222 &#40;50 &#37;&#41;
              samples spent in backtracking
              <br />
              4 &#40;0 &#37;&#41; &#40;ex.&#41;,
              48222 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from short_solve
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L145'>line 145</a>
              <br />
            </div>
            
            <span class='code'>    function backtracking&#40;prm, algprm, p_bar::Vector&#123;Float64&#125;, L::Float64, m_fixed::Vector&#123;Float64&#125;, n_fixed::Matrix&#123;Float64&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L198'>
          <td class='lineno'>198</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L199'>
          <td class='lineno'>199</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        i &#61; 0</span>
          </td>
        </tr>
        <tr id='L200'>
          <td class='lineno'>200</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        L_bar &#61; L</span>
          </td>
        </tr>
        <tr id='L201'>
          <td class='lineno'>201</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>24940 &#40;26 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              24939 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L94'>short_dual_df</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='simdloop.jl-57e60b307c4767fbecdad85a83bd62a23ba23086.html#L94'>short_dual_df</a>
              <br />
            </div>
            <span class='code'>        dRdW &#61; short_dual_df&#40;prm, p_bar, m_fixed, n_fixed&#41;</span>
          </td>
        </tr>
        <tr id='L202'>
          <td class='lineno'>202</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>11757 &#40;12 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              11757 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L78'>Z_SD</a>
              <br />
            </div>
            <span class='code'>        Z_SD_p_bar &#61; Z_SD&#40;prm, p_bar, m_fixed, n_fixed&#41;</span>
          </td>
        </tr>
        <tr id='L203'>
          <td class='lineno'>203</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L204'>
          <td class='lineno'>204</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for k in 1:10^6</span>
          </td>
        </tr>
        <tr id='L205'>
          <td class='lineno'>205</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>10 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              10 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>            p &#61; max.&#40;algprm.p_proj, p_bar .- dRdW ./ L_bar&#41;</span>
          </td>
        </tr>
        <tr id='L206'>
          <td class='lineno'>206</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L207'>
          <td class='lineno'>207</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>11513 &#40;12 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              11477 &#40;100 &#37;&#41;
              samples spent calling
              <a href='par_exp_Short_FISTA.jl-698d8adc59da36eb7d64e6423ac5d647f46b5ef4.html#L78'>Z_SD</a>
              <br />
              33 &#40;0 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-abce1a5297d55037e0b88bf8f47329c051482fd4.html#L903'>materialize</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='matmul.jl-4313d1118414e765d35d0447dce0d2adace246d1.html#L15'>dot</a>
              <br />
            </div>
            <span class='code'>            if Z_SD&#40;prm, p, m_fixed, n_fixed&#41; - &#40;Z_SD_p_bar &#43; dot&#40;p .- p_bar, dRdW&#41; &#43; 0.5 * L_bar * dot&#40;p .- p_bar, p .- p_bar&#41;&#41; &lt;&#61; 0.0</span>
          </td>
        </tr>
        <tr id='L208'>
          <td class='lineno'>208</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                break</span>
          </td>
        </tr>
        <tr id='L209'>
          <td class='lineno'>209</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L210'>
          <td class='lineno'>210</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L211'>
          <td class='lineno'>211</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            L_bar *&#61; algprm.eta</span>
          </td>
        </tr>
        <tr id='L212'>
          <td class='lineno'>212</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            i &#43;&#61; 1</span>
          </td>
        </tr>
        <tr id='L213'>
          <td class='lineno'>213</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L214'>
          <td class='lineno'>214</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L215'>
          <td class='lineno'>215</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return L_bar</span>
          </td>
        </tr>
        <tr id='L216'>
          <td class='lineno'>216</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L217'>
          <td class='lineno'>217</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L218'>
          <td class='lineno'>218</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#     function equilibrium&#40;</span>
          </td>
        </tr>
        <tr id='L219'>
          <td class='lineno'>219</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         R::Vector&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L220'>
          <td class='lineno'>220</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         W::Vector&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L221'>
          <td class='lineno'>221</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         m_fixed::Vector&#123;Float64&#125;,</span>
          </td>
        </tr>
        <tr id='L222'>
          <td class='lineno'>222</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         n_fixed::Matrix&#123;Float64&#125;</span>
          </td>
        </tr>
        <tr id='L223'>
          <td class='lineno'>223</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#     &#41;</span>
          </td>
        </tr>
        <tr id='L224'>
          <td class='lineno'>224</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         RW &#61; vcat&#40;R, W&#41;</span>
          </td>
        </tr>
        <tr id='L225'>
          <td class='lineno'>225</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         dRW &#61; short_dual_df&#40;RW, m_fixed, n_fixed&#41;</span>
          </td>
        </tr>
        <tr id='L226'>
          <td class='lineno'>226</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L227'>
          <td class='lineno'>227</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         dR &#61; dRW&#91;1:short.prm.K&#93;</span>
          </td>
        </tr>
        <tr id='L228'>
          <td class='lineno'>228</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         dW &#61; dRW&#91;&#40;short.prm.K &#43; 1&#41;:end&#93;</span>
          </td>
        </tr>
        <tr id='L229'>
          <td class='lineno'>229</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L230'>
          <td class='lineno'>230</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         equ_R &#61; maximum&#40;R .* dR&#41;</span>
          </td>
        </tr>
        <tr id='L231'>
          <td class='lineno'>231</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         equ_W &#61; maximum&#40;W .* dW&#41;</span>
          </td>
        </tr>
        <tr id='L232'>
          <td class='lineno'>232</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L233'>
          <td class='lineno'>233</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#         return equ_R, equ_W</span>
          </td>
        </tr>
        <tr id='L234'>
          <td class='lineno'>234</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#     end</span>
          </td>
        </tr>
        <tr id='L235'>
          <td class='lineno'>235</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L236'>
          <td class='lineno'>236</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end #module end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

